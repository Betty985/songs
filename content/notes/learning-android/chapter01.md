# 简介

Android 系统架构:

Linux 内核层、系统运行库层、应用框架层、应用层

四大组件:

Activity、Service、BroadcastReceiver 和 ContentProvider

应用程序模块可以直接运行，库模块只能作为代码库依附于别的应用程序模块运行。

Android Studio 项目共有三种依赖关系：本地依赖、库依赖和远程依赖。本地依赖可以对本地的 jar 包或目录添加依赖关系，库依赖可以对项目中的库模块添加依赖关系，远程依赖可以对 jcenter 仓库上的开源项目添加依赖关系。

编译语言大致分为两类：编译型语言和解释型语言。编译型语言的特点是编译器会将源码一次性编译成计算机可识别的二进制文件，然后计算机直接执行。解释型语言有一个解释器，在程序运行时，解释器会一行行读取源代码然后实时将源代码解释成计算机可识别的二进制数据后执行。

Java 准确来说时解释型语言。Java 代码编译之后并不是计算机可识别的二进制文件而是 class 文件。Java 虚拟机（ART）会将编译后的 class 文件解释成计算机可识别的二进制数据后再执行。Java 虚拟机不关心 class 文件是从 Java 编译来的还是从 Kotlin 编译来的。

# 语法

## 变量声明

- `val`声明一个不可变的变量，在初始赋值后就再也不能重新赋值。`var`声明一个可变的变量，这种变量在初始赋值之后仍然可以再被重新赋值。
- 字符串内嵌表达式在字符串模板中插入变量时，如果变量名不会引起歧义，可以直接使用`$变量名`的形式，而不需要使用`${变量名}`。如果需要在字符串模板中插入表达式，或者变量名可能引起歧义，就需要使用`${表达式}`的形式。
- kotlin 支持通过键值对传参。

## 逻辑控制

- Kotlin 的 if 有返回值。判断条件非常多的时候可以使用 when 语句，when 支持精确吗匹配和类型匹配（is 关键字）。如果不在 when 语句中传入参数的话可以在 when 后面直接写逻辑，省略小括号和参数。
- 循环：`..`可以创建闭区间,`until`创建左闭右开区间,`step`关键字可以跳过区间内的元素，`downTo`关键字创建降序区间

## 类与对象

- open 关键字告诉 Kotlin 编译器类可被继承。
- Kotlin 有两种构造函数：主构造函数和次构造函数。
  - 主构造函数是类头部的一部分，可以跟在类名后面。每个类默认都会有一个不带参数的主构造函数。特点是没有函数体，直接定义在类名的后面。可以在 init 结构体中编写主构造函数的逻辑。子类构造函数必须调用父类的构造函数，但是在绝大多数场景下不需要编写 init 结构体。
  - 一个类只能有一个主构造函数，但是可以有多个次构造函数。次构造函数也可以用于示例化一个类只不过它有函数体。次构造函数通过`constructor`关键字定义，通过`this`关键字调用主构造函数，仍然是合法的。当一个类既有主构造函数又有次构造函数时，所有的次构造函数都必须调用主构造函数。如果没有主构造函数继承的时候不需要加括号，次构造函数只能直接调用父类的构造函数，将`this` 换成`super`。几乎用不到次构造函数，因为 Kotlin **可以给函数设定参数默认值**。
- Kotlin 中实现接口和继承统一使用冒号，中间用逗号分隔。Kotlin 允许对接口中定义的函数进行默认实现。
  - `data`声明一个数据类，`object`声明单例类

## Lambda 编程

> - List 集合：声明集合后用`add`方法添加;`listOf`声明不可变 List 集合；`mutableListOf`声明可变 List 集合。
> - Set 集合（不可以存放重复元素）:`setOf`声明不可变 Set 集合；`mutableSetOf`声明可变 Set 集合。
> - Map 集合：HashMap 声明;`mapOf`和`mutableMapOf`

> `map`函数可以将集合中的每一个元素都映射成一个另外的值。
> `uppercase`函数将字符串中的所有小写字母转换为大写。
> `filter`函数过滤集合中的数据。
> `any`函数判断集合中是否至少存在一个元素满足指定条件
> `all`函数判断集合中是否所有元素都满足指定条件

Kotlin 匿名类完全舍弃了`new`关键字，而是改用了`object`关键字。
可以使用 lambda 表达式来代替只有一个方法的接口的实现
如果一个函数的参数是一个函数式接口（只有一个抽象方法的接口），那么在调用这个函数时，可以直接传入一个 lambda 表达式，而不需要显式地创建这个接口的实例。这是因为 Kotlin 会自动将 lambda 表达式转换为对应的函数式接口的实例。

Kotlin 调用 Java 单抽象方法接口可以使用函数式 API 简化写法。

## 空指针检查

空指针是一种不受编程语言检查的运行时异常。Kotlin 将空指针异常的检查提前到了编译期。

判空工具：

- `?.`

```kotlin
   val a=null
    if(a!==null){
        a.doSomething()
    }
```

简化为

```kotlin
a?.doSomething()
```

- `?:`

操作符左右两边都接收一个表达式，如果左边表达式结果不为空就返回左边表达式的结果，否则返回右边表达式的结果。

```kotlin
val c = if (a != null) {
    a
} else {
    b
}
```

简化为

```kotlin
val c = a ?: b
```

- `let`
  let 函数提供了函数式 API 的编程接口，将原始调用对象作为参数传递到 Lambda 表达式中

```kotlin
fun doStudy(study: Study?){
    study?.let {
        it.doHomework()
        it.readBooks()
    }
}
```

- `!!`  
  非空断言工具
